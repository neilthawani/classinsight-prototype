(this["webpackJsonpclassinsight-frontend"]=this["webpackJsonpclassinsight-frontend"]||[]).push([[0],{191:function(e,t,a){},221:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(1),i=a.n(n),r=a(37),c=a.n(r),o=(a(191),a(7)),l=a(21),d=a(77),u=a(78),h=a.n(u),p=a(25),b=a(3),j="GET_ERRORS",m="USER_LOADING",v="SET_CURRENT_USER",O="LIST_USERS",f="CREATE_USER",g="CLEAR_IS_VALID_USER",x="DELETE_USER",y="EDIT_USER",k="SHOW_USER",C="RESET_PASSWORD",T="LIST_DATASETS",S="UPLOAD_DATASET",w="DELETE_DATASET",N="EDIT_DATASET",D="SHOW_DATASET",E="CLEAR_VALID_STATE";var R=a(2),F=[{type:"Teacher",value:"Metacognitive Modeling Questions",text:"Metacognitive",barColor:"#10273d",speakerType:"Teacher",textColor:"white",description:"Teacher models for students how they should think through a problem using questioning that is not responded to by students."},{type:"Teacher",value:"Teacher Explanation + Evidence",text:"Explanation + Evidence",barColor:"#204e79",speakerType:"Teacher",textColor:"white",description:"Teacher models making connections to evidence. Like a student explanation + evidence code, teacher offers a modeled statement/example that includes reasoning grounded in a form of evidence. This might be anecdotal (an observation), scientific (pointing to the results of an experiment), a link to a resource previously reviewed in the class, etc."},{type:"Teacher",value:"Teacher Open-Ended S/Q",text:"Open-Ended Questions",barColor:"#3075b5",speakerType:"Teacher",textColor:"white",description:"Teacher asks students to respond in a way that offers a range of possibilities for responding. These questions or statements work to solicit extended responses that make connections."},{type:"Teacher",value:"Teacher Close-Ended S/Q",text:"Close-Ended Questions",barColor:"#5e9bd4",speakerType:"Teacher",textColor:"black",description:"Teacher asks students to respond in a way that provides limited possibilities for response (yes/no, known answer, fill in the blank). These questions are calls for recitation (correct answer) or calls for connection to previously taught content."},{type:"Teacher",value:"Assorted Teacher Talk",text:"Other Talk",barColor:"#d7e6f4",speakerType:"Teacher",textColor:"black"},{type:"Student",value:"Student Explanation + Evidence",text:"Explanation + Evidence",barColor:"#562810",speakerType:"Student",textColor:"white",description:"Students offer an open-ended response that includes reasoning grounded in a form of evidence. This might be anecdotal (an observation), scientific (pointing to the results of an experiment), a link to a resource previously reviewed in the class, etc."},{type:"Student",value:"Student Open-Ended S/Q",text:"Open-Ended Questions",barColor:"#97471c",speakerType:"Student",textColor:"white"},{type:"Student",value:"Student Open-Ended Response",text:"Open-Ended Response",barColor:"#d76528",speakerType:"Student",textColor:"white",description:'Students provide elaborated responses that move beyond what has been covered previously in the class/"correct answer" recitation.'},{type:"Student",value:"Student Close-Ended S/Q",text:"Close-Ended Questions",barColor:"#e39368",speakerType:"Student",textColor:"black"},{type:"Student",value:"Student Close-Ended Response",text:"Close-Ended Response",barColor:"#efc1a9",speakerType:"Student",textColor:"black",description:"Students respond with yes/no or known answer response."},{type:"Student",value:"Assorted Student Talk",text:"Other Talk",barColor:"#fbf0e9",speakerType:"Student",textColor:"black"},{type:"Technique",value:"Turn-Taking Facilitation",text:"Turn-Taking Facilitation",barColor:"#daacec",speakerType:"Teacher",textColor:"black",description:"Teacher directs a question to a specific student."},{type:"Technique",value:"Re-Voicing",text:"Re-Voicing",barColor:"#a22fd0",speakerType:"Teacher",textColor:"white",description:"Teacher restates/summarizes/rephrases/elaborates on a student response."},{type:"Technique",value:"Behavior Management Questions",text:"Behavior Management",barColor:"#411353",speakerType:"Teacher",textColor:"white",description:"This code is applied when a teacher asks a question that is managing behavior and/or task completion."},{type:"Teacher",value:"Video",text:"Video",barColor:"#29CB97",speakerType:"Teacher",textColor:"black",description:""}],U=function e(t){Object(R.a)(this,e),this.legendLabels=function(e){return this.talkRatios().filter((function(t){return t.type===e.type}))},this.transcript=function(){var e=[],t=0;return this.segments.forEach((function(a,s,n){"Other"!==a.participation_type&&a.speaking_turns.forEach((function(a,s,n){e.push({speakerPseudonym:a.speaker_pseudonym,speakerType:a.speaker_type,initialTime:a.initial_time,endTime:a.end_time,utterances:[]}),a.utterances.forEach((function(s,n,i){var r=0===s.utterance_type.length&&(a.speaker_pseudonym.includes("Class")||a.speaker_pseudonym.includes("Student")),c=0===s.utterance_type.length&&!a.speaker_pseudonym.includes("Student")&&!a.speaker_pseudonym.includes("Class")&&!a.speaker_pseudonym.includes("Video"),o=a.speaker_pseudonym.includes("Video"),l=a.speaker_pseudonym.includes("Video")?"Teacher (Video)":a.speaker_pseudonym,d={id:t++,timestamp:[],speakerPseudonym:l,speakerUtterances:[s.utterance],nTokens:s.n_tokens};s.timestamp.length&&d.timestamp.push(s.timestamp),d=r?Object(b.a)(Object(b.a)({},d),{utteranceTypes:["Assorted Student Talk"]}):c?Object(b.a)(Object(b.a)({},d),{utteranceTypes:["Assorted Teacher Talk"]}):o?Object(b.a)(Object(b.a)({},d),{utteranceTypes:["Video"]}):Object(b.a)(Object(b.a)({},d),{utteranceTypes:s.utterance_type}),e[e.length-1].utterances.push(d)}))}))})),e},this.filteredTranscript=function(e){var t=this.transcript(),a=e&&e.activeFilters;return t.reduce((function(e,t,s,n){var i=t.utterances.reduce((function(e,t,s,n){return a&&a.some((function(e){return t.utteranceTypes.includes(e)}))||e.push(t),e}),[]);return i.length&&(t.utterances=i,e.push(t)),e}),[])},this.drilldownTranscript=function(e){var t=this.transcript(),a=e&&e.drilldownFilter;return t.reduce((function(e,t,s,n){var i=t.utterances.reduce((function(e,t,s,n){return t.utteranceTypes.includes(a)&&e.push(t),e}),[]);return i.length&&(t.utterances=i,e.push(t)),e}),[])},this.expandedData=function(e){var t=e&&e.activeFilters;return this.filteredTranscript({activeFilters:t}).reduce((function(e,t,a,s){return e.concat(t.utterances)}),[])},this.maxNTokens=function(e){var t=e&&e.activeFilters,a=this.expandedData({activeFilters:t});return Math.max.apply(Math,a.map((function(e){return e.nTokens})))},this.collapsedData=function(e){var t=e&&e.activeFilters,a=this.expandedData({activeFilters:t}),s=[];return a.forEach((function(e,t,a){var n,i,r=Object(b.a)({},e),c=!1,o={};(s.length>0&&(o=Object(b.a)({},s[s.length-1]),c=JSON.stringify(o.utteranceTypes)===JSON.stringify(r.utteranceTypes)),c)&&(s[s.length-1].nTokens=o.nTokens+r.nTokens,(n=s[s.length-1].timestamp).push.apply(n,Object(p.a)(r.timestamp)),(i=s[s.length-1].speakerUtterances).push.apply(i,Object(p.a)(r.speakerUtterances)));(0===s.length||s.length>0&&!c)&&s.push(r)})),s},this.parsedData=function(e){var t=e&&e.activeFilters;return{expanded:this.expandedData({activeFilters:t}),collapsed:this.collapsedData({activeFilters:t})}},this.nTokensPerUtteranceType=function(){var e=this.expandedData(),t=F.map((function(e,t,a){return Object(b.a)(Object(b.a)({},e),{nTokens:0,percentage:0})}));return t.forEach((function(t,a,s){e.forEach((function(e,a,s){e.utteranceTypes.includes(t.value)&&(t.nTokens+=e.nTokens)}))})),t},this.talkRatios=function(){var e=this.nTokensPerUtteranceType(),t=this.initializeSpeakerTotals();t.forEach((function(t,a,s){t.totalNTokens=e.filter((function(e){return e.speakerType===t.speakerType})).map((function(e){return e.nTokens})).reduce((function(e,t,a,s){return e+=t}),0)}));var a=t.reduce((function(e,t){return e+t.totalNTokens}),0);return e.forEach((function(e,t,s){e.percentage=e.nTokens/a})),e},this.teacherTalkRatios=function(){return this.talkRatios().filter((function(e){return"Teacher"===e.type})).reverse()},this.studentTalkRatios=function(){return this.talkRatios().filter((function(e){return"Student"===e.type}))},this.initializeSpeakerTotals=function(){return F.reduce((function(e,t,a,s){return 0===e.filter((function(e){return e.speakerType===t.speakerType})).length&&e.push({speakerType:t.speakerType,totalNTokens:0}),e}),[])},this.speakerTalkTotals=function(){var e=this.initializeSpeakerTotals(),t=this.talkRatios();return e.forEach((function(e,a,s){t.forEach((function(t,a,s){e.speakerType===t.speakerType&&(e.hasOwnProperty("totalTalkPercentage")||(e.totalTalkPercentage=0),e.totalTalkPercentage+=t.percentage)}))})),e};var a;a=JSON.parse(t.jsonData),this.topic=t.classTopic,this.period=t.classPeriod,this.date=t.classDate,this.data=a,this.segments=a.segments,this.isActive=!1},I=a(4);function P(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=1*parseFloat(100*e).toFixed(t);return s&&(n+="%"),a&&e>0&&e<.01&&0===t&&(n="<1".concat(s?"%":"")),n}var L=function(e){return new Date(1e3*e).toISOString().substr(11,8)},A=function(){function e(t){Object(R.a)(this,e),this.legendLabels=function(e){return F.filter((function(t){return t.type===e.type}))},this.dataParsers=t}return Object(I.a)(e,[{key:"aggregatedParserRatios",value:function(){var e=this.dataParsers.reduce((function(e,t,a,s){var n=t.nTokensPerUtteranceType();e.hasOwnProperty(t.date)?e[t.date].forEach((function(e,t){e.nTokens+=n[t].nTokens})):e[t.date]=n;return e}),{}),t=Object.keys(e),a=F.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{data:[]})}));return t.forEach((function(t,s,n){var i=e[t],r=i.reduce((function(e,t){return e+=t.nTokens}),0),c=i.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{date:t,percentageValue:e.nTokens/r,formattedPercentageValue:P(e.nTokens/r,2,!0,!1),percentageLabel:P(e.nTokens/r,0)})}));a.forEach((function(e){var t=c.filter((function(t){return t.value===e.value}))[0];e.data.push({date:t.date,nTokens:t.nTokens,percentageValue:t.percentageValue,formattedPercentageValue:t.formattedPercentageValue,percentageLabel:t.percentageLabel})}))})),{Teacher:a.filter((function(e){return"Teacher"===e.type})),Student:a.filter((function(e){return"Student"===e.type}))}}},{key:"dateRange",value:function(){var e=this.aggregatedParserRatios().Teacher,t=e[0].data[0].date,a={start:e[0].data[e[0].data.length-1].date,end:t};return a}},{key:"averageDuration",value:function(){var e=this.dataParsers,t=e.reduce((function(e,t){return e+=t.data.duration}),0)/e.length;return L(t)}}]),e}();var _=a(200),B={isAuthenticated:!1,user:{},loading:!1};var M={};var z=Object(l.c)({admin:function(e,t){switch(t.type){case g:return Object(b.a)(Object(b.a)({},e),{},{isValidUser:null});case C:return Object(b.a)(Object(b.a)({},e),{},{passwordResetSuccessful:t.payload.passwordResetSuccessful});case O:return Object(b.a)(Object(b.a)({},e),{},{users:t.payload.data});case y:return{users:e.users.map((function(e){return e._id===t.payload.userData.user._id?t.payload.userData.user:e}))};case f:return{isValidUser:!0,users:[t.payload.user].concat(Object(p.a)(e.users))};case x:return{users:e.users.filter((function(e){return e._id!==t.payload.data.user._id}))};case j:return Object(b.a)(Object(b.a)({},e),{},{errors:t.payload});case k:return Object(b.a)(Object(b.a)({},e),{},{user:t.payload});default:return Object(b.a)({},e)}},datasets:function(e,t){switch(t.type){case T:(i=parseInt(localStorage.getItem("activeDataRowIndex"),10)||0)>=t.payload.length&&(i=0);var a=t.payload.sort((function(e,t){var a=e.classDate.split("-"),s=t.classDate.split("-");return a[0]-s[0]||a[1]-s[1]||a[2]-s[2]})).reverse(),s=a.map((function(e,t){var a=new U(e);return Object.assign(a,{isActive:t===i})})),n=new A(s);return Object(b.a)(Object(b.a)({},e),{},{datasets:a,dataParsers:s,activeDataRowIndex:i,activeDataset:a[i],activeParser:s[i],parserCollection:n});case N:return{datasets:e.datasets.map((function(e){return e._id===t.payload.dataset._id?t.payload.dataset:e}))};case S:return{datasets:[t.payload.dataset].concat(Object(p.a)(e.datasets)),isValid:!0};case w:return{datasets:e.datasets.filter((function(e){return e._id!==t.payload.dataset._id}))};case D:var i=t.payload;return t.payload>=e.datasets.length&&(i=0),Object(b.a)(Object(b.a)({},e),{},{activeDataset:e.datasets&&e.datasets[i],activeParser:e.dataParsers&&e.dataParsers[i],activeDataRowIndex:i});case E:return Object(b.a)(Object(b.a)({},e),{},{isValid:null});default:return e||{}}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(b.a)(Object(b.a)({},e),{},{isAuthenticated:!_(t.payload),user:t.payload});case m:return Object(b.a)(Object(b.a)({},e),{},{loading:!0});default:return e}},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return t.payload;default:return e}}}),V=[d.a,h.a],G=Object(l.e)(z,{},Object(l.d)(l.a.apply(void 0,V),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__()||l.d)),H=a(8),W=a(33),J=a(13),q=a.n(J),Q=function(e){e?q.a.defaults.headers.common.Authorization=e:delete q.a.defaults.headers.common.Authorization},X=function(e){return{type:v,payload:e}},Y=function(){return function(e){localStorage.removeItem("jwtToken"),Q(!1),e({type:j,payload:{}}),e(X({}))}},K=a(6),Z=a(5),$=a(12),ee=a(9),te=a.n(ee),ae=a(10),se=a(39),ne={clientId:"302262104197-a1u8tg76brir9v2pq8t17ej7spff4ueg.apps.googleusercontent.com",clientSecret:"PpyqkyVP-MH65fvJdRZb_5zQ"},ie=a.p+"static/media/classinsight-logo.db9a2834.png",re=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){var e;Object(R.a)(this,a);for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).onLogoutClick=function(t){t.preventDefault(),e.props.logoutUser()},e}return Object(I.a)(a,[{key:"onGoogleLogoutSuccess",value:function(e){this.props.logoutUser()}},{key:"render",value:function(){var e=this.props.auth.user,t=100===e.userType,a=0!==Object.keys(e).length;return Object(s.jsxs)("div",{className:"navbar",children:[Object(s.jsx)("div",{className:"navbar-logo",children:Object(s.jsx)(H.b,{to:{pathname:"/"},children:Object(s.jsx)("img",{src:ie,alt:"ClassInSight Logo",height:"50"})})}),a?Object(s.jsxs)("div",{className:"navbar-dropdown",children:[Object(s.jsxs)("div",{className:"navbar-dropdown-profile",children:[Object(s.jsx)("div",{className:"navbar-dropdown-profile-photo",children:Object(s.jsx)(te.a,{path:ae.a,className:"navbar-dropdown-icon",size:1.5})}),Object(s.jsx)("p",{className:"navbar-dropdown-profile-name",children:e.name})]}),Object(s.jsx)(te.a,{path:ae.g,className:"navbar-dropdown-icon",size:1}),Object(s.jsxs)("div",{className:"navbar-dropdown-menu",children:[t?Object(s.jsx)(H.b,{to:"/admin",children:Object(s.jsxs)("div",{className:"navbar-dropdown-menu-item",children:[Object(s.jsx)(te.a,{path:ae.d,className:"navbar-dropdown-menu-item-icon",size:1}),Object(s.jsx)("span",{className:"navbar-dropdown-menu-item-link",children:"Manage Users"})]})}):"",this.props.auth.user.isGoogleUser?Object(s.jsxs)("div",{className:"navbar-dropdown-menu-item",children:[Object(s.jsx)(te.a,{path:ae.k,className:"navbar-dropdown-menu-item-icon",size:1}),Object(s.jsx)(se.GoogleLogout,{clientId:ne.clientId,render:function(e){return Object(s.jsx)("span",{onClick:e.onClick,disabled:e.disabled,children:"Logout"})},buttonText:"Logout",onLogoutSuccess:this.onGoogleLogoutSuccess.bind(this)})]}):Object(s.jsxs)("div",{className:"navbar-dropdown-menu-item",children:[Object(s.jsx)(te.a,{path:ae.k,className:"navbar-dropdown-menu-item-icon",size:1}),Object(s.jsx)("span",{className:"navbar-dropdown-menu-item-link",onClick:this.onLogoutClick,children:"Logout"})]})]})]}):""]})}}]),a}(n.Component),ce=Object(o.b)((function(e){return{auth:e.auth}}),{logoutUser:Y})(re),oe=function(e){return function(t){t({type:D,payload:e})}},le=function(e){return function(t){return q.a.get("/api/datasets/list",{params:{userId:e}}).then((function(e){return e&&e.data})).then((function(e){t({type:T,payload:e})})).catch((function(e){throw e}))}},de=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&(this.props.listDatasets(this.props.auth.user.id),this.props.history.push("/visualization/dashboard"))}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"auth-form-container form-container",children:[Object(s.jsx)(H.b,{to:"/register",className:"btn",children:"Register"}),Object(s.jsx)(H.b,{to:"/login",className:"btn",children:"Log In"})]})}}]),a}(n.Component),ue=Object($.f)(Object(o.b)((function(e){return{auth:e.auth,errors:e.errors,datasets:e.datasets}}),{listDatasets:le})(de)),he=a(11),pe=a.n(he),be=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){var e;return Object(R.a)(this,a),(e=t.call(this)).onChange=function(t){e.setState({[t.target.id]:t.target.value})},e.onSubmit=function(t){t.preventDefault();var a={name:e.state.name,email:e.state.email,password:e.state.password,password2:e.state.password2};e.props.registerUser(a,e.props.history)},e.state={name:"",email:"",password:"",password2:"",errors:{}},e}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/dashboard")}},{key:"render",value:function(){var e=this.state.errors;return Object(s.jsxs)("div",{className:"auth-form-container form-container",children:[Object(s.jsx)("h2",{className:"text-center",children:"Register"}),Object(s.jsxs)("form",{noValidate:!0,onSubmit:this.onSubmit,children:[Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"name",children:"Name"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.name,error:e.name,id:"name",type:"text",autoComplete:"username",className:pe()("",{invalid:e.name})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.name})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"email",children:"Email"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.email,error:e.email,id:"email",type:"email",className:pe()("",{invalid:e.email})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.email})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password,error:e.password,id:"password",type:"password",className:pe()("",{invalid:e.password})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password2,error:e.password2,id:"password2",type:"password",className:pe()("",{invalid:e.password2})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password2})]}),Object(s.jsx)("button",{type:"submit",className:"btn btn-submit",children:"Sign up"})]}),Object(s.jsxs)("span",{className:"text-with-link",children:["Already have an account? \xa0",Object(s.jsx)(H.b,{to:"/login",className:"link",children:"Log in"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.errors?{errors:e.errors}:null}}]),a}(n.Component),je=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{registerUser:function(e,t){return function(a){q.a.post("/api/users/register",e).then((function(e){return t.push("/login")})).catch((function(e){return a({type:j,payload:e.response.data})}))}}})(Object($.f)(be)),me=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){var e;return Object(R.a)(this,a),(e=t.call(this)).onChange=function(t){e.setState({[t.target.id]:t.target.value})},e.onSubmit=function(t){t.preventDefault();var a={email:e.state.email,password:e.state.password};e.props.loginUser(a)},e.state={email:"",password:"",errors:{}},e}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/visualization/dashboard")}},{key:"onGoogleSuccess",value:function(e){this.props.loginWithGoogle(e)}},{key:"onGoogleFailure",value:function(e){this.props.loginWithGoogle(e)}},{key:"render",value:function(){var e=this.state.errors;return Object(s.jsxs)("div",{className:"auth-form-container form-container",children:[Object(s.jsx)("h2",{className:"text-center",children:"Login"}),Object(s.jsxs)("form",{noValidate:!0,onSubmit:this.onSubmit,children:[Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"email",children:"Email"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.email,error:e.email,id:"email",type:"email",autoComplete:"username",className:pe()("",{invalid:e.email||e.emailnotfound})}),Object(s.jsxs)("span",{className:"input-field-error-text",children:[e.email,e.emailnotfound]})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password,error:e.password,id:"password",type:"password",autoComplete:"current-password",className:pe()("",{invalid:e.password||e.passwordincorrect})}),Object(s.jsxs)("span",{className:"input-field-error-text",children:[e.password,e.passwordincorrect]})]}),Object(s.jsx)("button",{type:"submit",className:"btn btn-submit",children:"Login"})]}),Object(s.jsxs)("div",{className:"google-form",children:[Object(s.jsxs)("div",{className:"google-form-option",children:[Object(s.jsx)("div",{className:"google-form-option-line"}),Object(s.jsx)("span",{className:"google-form-option-or",children:"OR"}),Object(s.jsx)("div",{className:"google-form-option-line"})]}),Object(s.jsx)(se.GoogleLogin,{clientId:ne.clientId,buttonText:"Sign in with Google",theme:"dark",onSuccess:this.onGoogleSuccess.bind(this),onFailure:this.onGoogleFailure.bind(this),cookiePolicy:"single_host_origin",isSignedIn:!0})]}),Object(s.jsxs)("span",{className:"text-with-link",children:["Don't have an account? \xa0",Object(s.jsx)(H.b,{to:"/register",className:"link",children:"Register"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.auth.isAuthenticated&&e.history.push("/visualization/dashboard"),e.errors?{errors:e.errors}:null}}]),a}(n.Component),ve=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{loginUser:function(e){return function(t){q.a.post("/api/users/login",e).then((function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),Q(a);var s=Object(W.a)(a);t(X(s))})).catch((function(e){return t({type:j,payload:e.response.data})}))}},loginWithGoogle:function(e){return function(t){q.a.post("/api/users/google-login/",e).then((function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),Q(a);var s=Object(W.a)(a);t(X(s))})).catch((function(e){t({type:j,payload:e.response&&e.response.data})}))}}})(me),Oe=a(40),fe=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.component,a=e.auth,n=Object(Oe.a)(e,["component","auth"]);return Object(s.jsx)($.b,Object(b.a)(Object(b.a)({},n),{},{render:function(e){return!0===a.isAuthenticated?Object(s.jsx)(t,Object(b.a)({},e)):Object(s.jsx)($.a,{to:"/login"})}}))})),ge=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={width:e.width,height:e.height,display:e.activeLabel===e.label?"block":"none"},s}return Object(I.a)(a,[{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"styles",value:function(){return{width:"".concat(this.state.width,"px"),height:"".concat(this.state.height,"px"),display:this.props.label.description?this.state.display:"none"}}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"hover-box",style:this.styles(),children:[Object(s.jsx)("div",{className:"hover-box-title"}),Object(s.jsx)("div",{className:"hover-box-text",children:this.props.label.description})]})}}]),a}(n.Component),xe=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={activeLabel:{}},s}return Object(I.a)(a,[{key:"styles",value:function(e){return{backgroundColor:this.isActive()?e.barColor:"transparent",color:e.textColor}}},{key:"isActive",value:function(){return this.props.activeFilters&&!this.props.activeFilters.includes(this.props.label.value)||!this.props.activeFilters}},{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"toggleDefinitionDisplay",value:function(e){var t=this.state.activeLabel===e?"":e;this.setState({activeLabel:t})}},{key:"render",value:function(){var e=this.props.label,t=this.state.activeLabel;return Object(s.jsxs)("div",{className:"legend-item",children:[Object(s.jsx)("div",{className:"legend-item-key",style:this.styles(e,this.isActive()),onClick:this.handleClick.bind(this,e),children:this.props.displayRatio?P(e.percentage,0):""}),Object(s.jsx)("span",{className:"legend-item-label",onMouseOver:this.toggleDefinitionDisplay.bind(this,e),onMouseOut:this.toggleDefinitionDisplay.bind(this,e),children:e.text}),t?Object(s.jsx)(ge,{label:e,activeLabel:t,width:200,height:"max-content"}):""]})}}]),a}(n.Component),ye=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"render",value:function(){var e=this,t=this.props.labels;return Object(s.jsx)("div",{className:"legend-item-container",children:t.map((function(t,a){return"Video"===t.value&&0===t.percentage?null:Object(s.jsx)(xe,{label:t,activeFilters:e.props.activeFilters,displayRatio:e.props.displayRatio,handleClick:e.handleClick.bind(e)},a)}))})}}]),a}(n.Component),ke=a(17),Ce=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleCircleTooltip",value:function(e){this.props.handleCircleTooltip(e)}},{key:"render",value:function(){var e=this.props.xScale,t=this.props.yScale,a=this.props.point;return Object(s.jsx)("g",{children:Object(s.jsx)("circle",{className:"trend-chart-line-point",onMouseOver:this.handleCircleTooltip.bind(this,this.props.point),onMouseOut:this.handleCircleTooltip.bind(this,null),r:"4",fill:a.barColor,cx:e(a.date),cy:t(a.score)})})}}]),a}(n.Component),Te=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleCircleTooltip",value:function(e){this.props.handleCircleTooltip(e)}},{key:"render",value:function(){var e=this,t=this.props.xScale,a=this.props.yScale,n=this.props.trendLine,i=this.props.trendLineDatum,r=this.props.color;return Object(s.jsxs)("g",{className:"trend-chart-path-group",children:[Object(s.jsx)("path",{className:"trend-chart-line",d:n(i),stroke:r}),i.map((function(n,i){return Object(s.jsx)(Ce,{xScale:t,yScale:a,point:n,handleCircleTooltip:e.handleCircleTooltip.bind(e)},"circle-".concat(i))}))]})}}]),a}(n.Component),Se=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).ref=i.a.createRef(),s}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.ref.current&&ke.g(this.ref.current).attr("class",this.props.className).attr("transform",this.props.transform).call(this.props.axis)}},{key:"componentDidUpdate",value:function(){this.ref.current&&ke.g(this.ref.current).transition().attr("class",this.props.className).attr("transform",this.props.transform).call(this.props.axis)}},{key:"render",value:function(){return Object(s.jsx)("g",{ref:this.ref})}}]),a}(n.Component),we=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleCircleTooltip",value:function(e){this.props.handleCircleTooltip(e)}},{key:"render",value:function(){var e=this,t=this.props.scales.xScale,a=this.props.scales.yScale,n=ke.d().x((function(e){return t(e.date)})).y((function(e){return a(e.score)}));return Object(s.jsxs)("svg",{className:"trend-chart-svg",width:this.props.svgWidth,height:this.props.svgHeight,children:[this.props.axes.yAxis.scale().ticks().map((function(t,n,i){return 0===n?null:Object(s.jsx)("line",{className:"trend-chart-gridline",x1:e.props.margin.left,y1:a(t),x2:e.props.svgWidth-e.props.margin.right,y2:a(t)},"gridline-".concat(t,"-").concat(n))})),this.props.trendLineData.map((function(i,r,c){var o=i[0].barColor;return Object(s.jsx)(Te,{xScale:t,yScale:a,trendLine:n,trendLineDatum:i,color:o,handleCircleTooltip:e.handleCircleTooltip.bind(e)},r)})),this.props.circleTooltip?Object(s.jsxs)("g",{className:"trend-chart-tooltip-extent",children:[Object(s.jsx)("line",{x1:t(this.props.circleTooltip.date),y1:a(this.props.circleTooltip.score),x2:t(this.props.circleTooltip.date),y2:this.props.svgHeight-this.props.margin.top}),Object(s.jsx)("line",{x1:t(this.props.circleTooltip.date)+1,y1:a(this.props.circleTooltip.score)+1,x2:this.props.margin.right,y2:a(this.props.circleTooltip.score)+1})]}):null,Object(s.jsx)(Se,{className:"x axis",transform:this.props.axes.transforms.x,axis:this.props.axes.xAxis}),Object(s.jsx)(Se,{className:"y axis",transform:this.props.axes.transforms.y,axis:this.props.axes.yAxis})]})}}]),a}(n.Component),Ne=(a(80),a(81)),De=function(e){return[].concat.apply([],e)},Ee=a(79),Re=a.n(Ee),Fe=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).parseTime=ke.i("%Y-%m-%d"),s.parseData=function(e){var t=this;return e.map((function(e){return{date:t.parseTime(e.date),score:e.formattedPercentageValue}}))},s.state={uuid:Re()(),circleTooltip:null,scales:{},axes:{},display:{svgWidth:0,svgHeight:0,margin:{top:25,right:25,bottom:25,left:25}},isLoaded:!1},s}return Object(I.a)(a,[{key:"handleCircleTooltip",value:function(e){this.setState({circleTooltip:e})}},{key:"calculateXScale",value:function(e,t){return e.domain(ke.c(t,(function(e){return e.date})))}},{key:"calculateYScale",value:function(e,t){var a=Math.ceil(Math.min.apply(Math,t.map((function(e){return e.score})))),s=5*Math.ceil(Math.max.apply(Math,t.map((function(e){return e.score})))/5);return e.domain([a,s])}},{key:"componentDidMount",value:function(){var e=this,t=this.state.display.margin,a=document.getElementById("trend-chart-container-".concat(this.state.uuid)).clientWidth,s=document.getElementById("trend-chart-container-".concat(this.state.uuid)).clientHeight,n=ke.f().range([t.left,a-t.right]),i=ke.e().range([s-t.bottom,t.top]),r=this.props.data.map((function(t){return e.parseData(t.data)})),c=this.calculateXScale(n,De(r)),o=this.calculateYScale(i,De(r)),l=ke.a(c).tickFormat(ke.h("%m-%d")),d=ke.b(o),u="translate(0,"+parseInt(s-t.top,0)+")",h="translate(".concat(t.bottom,", 0)");this.setState({display:Object(b.a)(Object(b.a)({},this.state.display),{},{svgWidth:a,svgHeight:s}),scales:{xScale:c,yScale:o},axes:{xAxis:l,yAxis:d,transforms:{x:u,y:h}},isLoaded:!0})}},{key:"render",value:function(){var e=this;if(this.state.isLoaded){var t=this.state,a=this.props.activeFilters,n=this.props.data.reduce((function(t,s){if(!a.includes(s.value)){var n=((r=s)[c="data"],Object(Oe.a)(r,[c].map(Ne.a))),i=e.parseData(s.data).map((function(e){return Object(b.a)(Object(b.a)({},e),n)}));t.push(i)}var r,c;return t}),[]);return Object(s.jsxs)("div",{className:"trend-chart-container",id:"trend-chart-container-".concat(this.state.uuid),children:[Object(s.jsx)(we,{svgWidth:this.state.display.svgWidth,svgHeight:this.state.display.svgHeight,margin:this.state.display.margin,axes:this.state.axes,scales:t.scales,trendLineData:n,circleTooltip:this.state.circleTooltip,handleCircleTooltip:this.handleCircleTooltip.bind(this)}),Object(s.jsx)("span",{className:"trend-chart-container-tooltip",children:this.state.circleTooltip?"".concat(this.state.circleTooltip.text," (").concat(this.state.circleTooltip.score.toFixed(1),"%)"):null})]})}return Object(s.jsx)("div",{className:"trend-chart-container",id:"trend-chart-container-".concat(this.state.uuid)})}}]),a}(n.Component),Ue=a(223);function Ie(e){var t=e.split("-").reduce((function(e,t,a){switch(a){case 0:e.year=parseInt(t,10);break;case 1:e.month=parseInt(t,10)-1;break;case 2:e.date=parseInt(t,10)}return e}),{year:0,month:0,date:0});return Object(Ue.a)(new Date(t.year,t.month,t.date),"PPP")}function Pe(e,t){var a=t.indexOf(e);return a>-1&&t.splice(a,1),t}var Le=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={activeFilters:[]},s}return Object(I.a)(a,[{key:"handleFilterClick",value:function(e){var t=this.state.activeFilters;t.includes(e.value)?t=Pe(e.value,t):t.push(e.value),this.setState({activeFilters:t})}},{key:"render",value:function(){if(!this.props.datasets.activeParser)return Object(s.jsx)("div",{className:"dashboard-container",children:Object(s.jsx)("h2",{children:"Please upload data to use ClassInSight."})});var e=this.props.datasets.parserCollection;return e.dataParsers.length<2?Object(s.jsx)("div",{className:"dashboard-container",children:Object(s.jsx)("h2",{children:"Please upload more than one data set to view aggregated data."})}):Object(s.jsxs)("div",{className:"dashboard-container",children:[Object(s.jsxs)("div",{className:"overview-heading",children:[Object(s.jsx)("h3",{className:"overview-heading-label",children:"Overview"}),Object(s.jsxs)("select",{className:"overview-heading-dropdown",children:[Object(s.jsx)("option",{children:"all time"}),Object(s.jsx)("option",{children:"this month"}),Object(s.jsx)("option",{children:"this week"})]}),Object(s.jsxs)("h3",{className:"overview-heading-label",children:[Ie(e.dateRange().start)," - ",Ie(e.dateRange().end)," (Average duration: ",e.averageDuration(),")"]})]}),Object(s.jsxs)("div",{className:"even-columns-2",children:[Object(s.jsxs)("div",{className:"even-column",children:[Object(s.jsx)("h4",{className:"text-center",children:"Teacher"}),Object(s.jsxs)("div",{className:"overview-trend-chart-container",children:[Object(s.jsx)(ye,{labels:e.legendLabels({type:"Teacher"}),activeFilters:this.state.activeFilters,displayRatio:!1,handleClick:this.handleFilterClick.bind(this)}),Object(s.jsx)(Fe,{data:e.aggregatedParserRatios().Teacher,activeFilters:this.state.activeFilters})]})]}),Object(s.jsxs)("div",{className:"even-column",children:[Object(s.jsx)("h4",{className:"text-center",children:"Student"}),Object(s.jsxs)("div",{className:"overview-trend-chart-container",children:[Object(s.jsx)(ye,{labels:e.legendLabels({type:"Student"}),activeFilters:this.state.activeFilters,displayRatio:!1,handleClick:this.handleFilterClick.bind(this)}),Object(s.jsx)(Fe,{data:e.aggregatedParserRatios().Student,activeFilters:this.state.activeFilters})]})]})]})]})}}]),a}(n.Component);var Ae=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(Le)),_e=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"formatStyle",value:function(e){return{height:"50px",width:P(e.percentage,2,!1),backgroundColor:e.barColor}}},{key:"handleTalkRatioSectionClick",value:function(e){this.props.handleTalkRatioSectionClick(e)}},{key:"render",value:function(){var e=this.props.data;return Object(s.jsx)("div",{className:e.percentage>0?"talk-ratio-visualization-section":"",style:this.formatStyle(e),onClick:this.props.handleTalkRatioSectionClick.bind(this,e)})}}]),a}(n.Component),Be=F;function Me(e){var t=e.utteranceTypes[e.utteranceTypes.length-1],a=Be.find((function(e){return e.value===t})),s=a.textColor,n=a.barColor,i="",r="";if(e.utteranceTypes.length>1){var c=e.utteranceTypes&&e.utteranceTypes[0];i="3px solid ".concat(Be.find((function(e){return e.value===c})).barColor),r="border-box"}return{color:s,backgroundColor:n,border:i,boxSizing:r}}var ze=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleUtteranceClick",value:function(e){this.props.handleUtteranceClick(e)}},{key:"render",value:function(){var e=this,t=this.props.timeStamp,a=this.props.utterance,n=this.props.activeLabels,i=!1;if(n)for(var r=0;r<a.utteranceTypes.length;r++)if(n.includes(a.utteranceTypes[r])){i=!0;break}return Object(s.jsxs)("tr",{className:"script-turn-utterance","data-attr-utterance-id":a.id,id:a.id,onClick:this.handleUtteranceClick.bind(this,a.id),children:[Object(s.jsx)("td",{className:"script-turn-utterance-timestamp",children:t}),a.speakerUtterances.map((function(t,n,r){return Object(s.jsx)("td",{className:e.props.canInspect?"script-turn-utterance-text inspectable":"script-turn-utterance-text",style:i?Me(a):{},children:t},n)}))]})}}]),a}(n.Component),Ve=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=window.location.href;if(e.indexOf("#")>-1){var t=e.slice(e.indexOf("#")+1,e.length);window.setTimeout((function(){var e=document.getElementById(t),a=document.getElementsByClassName("navbar")[0].clientHeight+document.getElementsByClassName("button-selector")[0].clientHeight,s=e.getBoundingClientRect().top-a;window.scrollTo({top:s,behavior:"smooth"})}),1e3)}window.addEventListener("scroll",this.handleScroll.bind(this)),this.handleScroll()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll.bind(this))}},{key:"getElementIdsForFocusWindow",value:function(){for(var e=document.getElementsByClassName("script-turn-utterance"),t=[],a=0;a<e.length;a++){var s=e[a],n=s.getBoundingClientRect(),i=n.top>=0&&n.left>=0&&n.right<=(window.innerWidth||document.documentElement.clientWidth)&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight);if(i)t.push(s);else if(t.length>0&&!i)break}var r=0,c=0;return t.length&&(r=parseInt(t[0].getAttribute("data-attr-utterance-id"),10),c=parseInt(t[t.length-1].getAttribute("data-attr-utterance-id"),10)),{topElId:r,bottomElId:c}}},{key:"handleScroll",value:function(e){var t=this.getElementIdsForFocusWindow(),a=t.topElId,s=t.bottomElId;this.props.handleScroll(a,s)}},{key:"handleUtteranceClick",value:function(e){this.props.handleUtteranceClick(e)}},{key:"render",value:function(){var e=this,t=this.props.drilldownFilter,a=this.props.transcript;return t&&(a=this.props.parser.drilldownTranscript({drilldownFilter:t})),Object(s.jsx)("div",{className:"script-turn-container",children:a.map((function(t,a,n){return Object(s.jsx)("table",{className:"script-turn",children:Object(s.jsxs)("tbody",{className:"script-turn-rows",children:[Object(s.jsxs)("tr",{className:"script-turn-speaker",children:[Object(s.jsxs)("td",{className:"script-turn-speaker-timestamp",children:[t.initialTime," - ",t.endTime]}),Object(s.jsx)("td",{className:"script-turn-speaker-text",children:t.speakerPseudonym})]}),t.utterances.map((function(t,a,n){var i=t.timestamp.length>0,r="".concat(t,"-").concat(a),c=i?t.timestamp:"";return Object(s.jsx)(ze,{timeStamp:c,utterance:t,activeLabels:e.props.activeLabels,canInspect:e.props.canInspect,handleUtteranceClick:e.handleUtteranceClick.bind(e)},r)}))]})},a)}))})}}]),a}(n.Component),Ge=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={drilldownFilter:""},s}return Object(I.a)(a,[{key:"calculateSpeakerTotal",value:function(e){return this.props.datasets.activeParser.speakerTalkTotals().filter((function(t){return t.speakerType===e}))[0].totalTalkPercentage}},{key:"handleTalkRatioSectionClick",value:function(e){var t=e.value===this.state.drilldownFilter?"":e.value;t===this.state.drilldownFilter&&(t=""),this.setState({drilldownFilter:t})}},{key:"handleUtteranceClick",value:function(e){var t=this.props.location.pathname.slice(this.props.location.pathname.lastIndexOf("/")),a=this.props.location.pathname.replace(t,"/transcript#".concat(e));this.props.history.push(a)}},{key:"render",value:function(){var e=this;if(!this.props.datasets.activeParser)return null;var t=this.props.datasets.activeParser,a=t.teacherTalkRatios(),n=t.studentTalkRatios(),i=t.transcript();return Object(s.jsxs)("div",{className:"talk-ratio-visualization-container",children:[Object(s.jsxs)("div",{className:"talk-ratio-legend-teacher",children:[Object(s.jsxs)("h3",{className:"talk-ratio-visualization-heading",children:["Teacher Talk: ",P(this.calculateSpeakerTotal("Teacher"),0)]}),Object(s.jsx)(ye,{labels:t.legendLabels({type:"Teacher"}),displayRatio:!0,handleClick:function(){}}),Object(s.jsx)(ye,{labels:t.legendLabels({type:"Media"}),displayRatio:!0,handleClick:function(){}})]}),Object(s.jsxs)("div",{className:"talk-ratio-visualization",children:[Object(s.jsxs)("div",{className:"talk-ratio-visualization-chart",children:[a.map((function(t,a,n){return Object(s.jsx)(_e,{data:t,handleTalkRatioSectionClick:e.handleTalkRatioSectionClick.bind(e)},a)})),Object(s.jsx)("div",{className:"talk-ratio-visualization-divider"}),n.map((function(t,a,n){return Object(s.jsx)(_e,{data:t,handleTalkRatioSectionClick:e.handleTalkRatioSectionClick.bind(e)},a)}))]}),Object(s.jsx)("div",{className:"talk-ratio-visualization-drilldown",children:this.state.drilldownFilter?Object(s.jsx)(Ve,{parser:t,transcript:i,drilldownFilter:this.state.drilldownFilter,canInspect:!0,handleUtteranceClick:this.handleUtteranceClick.bind(this),handleScroll:function(){}}):""})]}),Object(s.jsxs)("div",{className:"talk-ratio-legend-student",children:[Object(s.jsxs)("h3",{className:"talk-ratio-visualization-heading text-right",children:["Student Talk: ",P(this.calculateSpeakerTotal("Student"),0)]}),Object(s.jsx)(ye,{labels:t.legendLabels({type:"Student"}),displayRatio:!0,handleClick:function(){}})]})]})}}]),a}(n.Component);var He=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(Ge)),We=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"styles",value:function(e){var t={};return this.props.activeLabels.includes(e.value)&&(t={backgroundColor:e.barColor,color:e.textColor}),t}},{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"render",value:function(){var e=this.props.label;return Object(s.jsxs)("div",{className:"legend-button",style:this.styles(e),onClick:this.handleClick.bind(this,e),children:[e.text," ",this.props.displayRatio?"(".concat(P(e.percentage,0),")"):""]})}}]),a}(n.Component),Je=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={isCollapsed:!1},s}return Object(I.a)(a,[{key:"toggleGroup",value:function(e){this.setState({isCollapsed:!e})}},{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"render",value:function(){var e=this,t=this.state.isCollapsed,a=this.props.labels;return Object(s.jsxs)("div",{className:"legend-button-container",children:[Object(s.jsxs)("div",{className:t?"legend-button-dropdown collapsed":"legend-button-dropdown",onClick:this.toggleGroup.bind(this,this.state.isCollapsed),children:[Object(s.jsx)("span",{className:"legend-button-dropdown-text",children:a[0].type}),t?Object(s.jsx)(te.a,{path:ae.h,className:"legend-button-dropdown-toggle",size:1}):Object(s.jsx)(te.a,{path:ae.g,className:"legend-button-dropdown-toggle",size:1})]}),Object(s.jsx)("div",{className:"legend-buttons",children:a.map((function(t,a){return"Video"===t.value&&0===t.percentage?null:Object(s.jsx)(We,{label:t,displayRatio:e.props.displayRatio,activeLabels:e.props.activeLabels,handleClick:e.handleClick.bind(e,t)},a)}))})]})}}]),a}(n.Component);function qe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.speakerPseudonym.includes("Student"),s=!e.speakerPseudonym.includes("Student"),n=Me(e),i=e.nTokens,r="14px";t&&(r="3px");var c={height:r},o=Object(b.a)(Object(b.a)({},n),{},{width:i}),l={},d={};return s&&(d=c,l=Object(b.a)(Object(b.a)({},c),o)),a&&(d=Object(b.a)(Object(b.a)({},c),o),l=c),{teacherStyle:l,studentStyle:d}}var Qe=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){var e=this.props.parser.parsedData().expanded,t=this.props.chartWidth,a=this.props.barHeight,n=this.props.focusBox,i=n.height+a,r=a*n.topElId;return Object(s.jsxs)("div",{className:"turn-taking-bars-small-visualization",style:{minWidth:"".concat(t,"px")},children:[e.map((function(e,t){var n=qe(e,!0),i=n.teacherStyle,r=n.studentStyle;return Object(s.jsxs)("div",{className:"turn-taking-bar-small","data-attr-utterance-id":e.id,style:{height:"".concat(a,"px")},children:[Object(s.jsx)("div",{className:"turn-taking-bar-teacher-outer",children:Object(s.jsx)("div",{className:"turn-taking-bar-teacher-inner",style:i})}),Object(s.jsx)("div",{className:"turn-taking-bar-student-outer",children:Object(s.jsx)("div",{className:"turn-taking-bar-student-inner",style:r})})]},t)})),Object(s.jsx)("div",{className:"turn-taking-bars-small-focus-box",style:{height:"".concat(i,"px"),top:r}})]})}}]),a}(n.Component),Xe=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).barHeight=3,s.state={activeLabels:[],focusBox:{topElId:0,bottomElId:0,y:0,height:0}},s}return Object(I.a)(a,[{key:"handleClick",value:function(e){var t=this.state.activeLabels;t.includes(e.value)?t=Pe(e.value,t):t.push(e.value),this.setState({activeLabels:t})}},{key:"handleScroll",value:function(e,t){var a=document.getElementsByClassName("turn-taking-bars-small-visualization")[0];if(a){var s=a.querySelectorAll(".turn-taking-bars-small-visualization [data-attr-utterance-id='".concat(e,"']"))[0],n=a.querySelectorAll(".turn-taking-bars-small-visualization [data-attr-utterance-id='".concat(t,"']"))[0],i=s.getBoundingClientRect().y,r=n.getBoundingClientRect().y-i+1;a.scrollTo(0,e*this.barHeight);var c={topElId:e,bottomElId:t,height:r};this.setState({focusBox:c})}}},{key:"render",value:function(){if(!this.props.datasets.activeParser)return null;var e=this.props.datasets.activeParser,t=2*e.maxNTokens(),a=e.transcript();return Object(s.jsxs)("div",{className:"transcript-visualization-container",children:[Object(s.jsxs)("div",{className:"transcript-visualization-legend",children:[Object(s.jsx)(Je,{labels:e.legendLabels({type:"Teacher"}),displayRatio:!0,activeLabels:this.state.activeLabels,handleClick:this.handleClick.bind(this)}),Object(s.jsx)(Je,{labels:e.legendLabels({type:"Student"}),displayRatio:!0,activeLabels:this.state.activeLabels,handleClick:this.handleClick.bind(this)}),Object(s.jsx)(Je,{labels:e.legendLabels({type:"Technique"}),displayRatio:!0,activeLabels:this.state.activeLabels,handleClick:this.handleClick.bind(this)})]}),Object(s.jsx)(Qe,{parser:e,chartWidth:t,barHeight:this.barHeight,focusBox:this.state.focusBox}),Object(s.jsx)("div",{className:"transcript-script-container",style:{marginLeft:"".concat(t,"px")},children:Object(s.jsx)(Ve,{transcript:a,activeLabels:this.state.activeLabels,focusBox:this.state.focusBox,handleScroll:this.handleScroll.bind(this),handleUtteranceClick:function(){}})})]})}}]),a}(n.Component);var Ye=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(Xe)),Ke=a(34),Ze=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"handleTextClick",value:function(e){this.props.handleTextClick(e)}},{key:"render",value:function(){var e=this,t=this.props.data;return Object(s.jsx)("div",{className:"script-turn-container",id:t.id,onClick:this.handleTextClick.bind(this,t.id),children:Object(s.jsx)("table",{className:"script-turn",children:Object(s.jsxs)("tbody",{className:"script-turn-rows",children:[Object(s.jsx)("tr",{className:"script-turn-speaker",children:Object(s.jsx)("td",{className:"script-turn-speaker-text",children:t.speakerPseudonym})}),t.speakerUtterances.map((function(t,a,n){return Object(s.jsx)("tr",{className:"script-turn-utterance",children:Object(s.jsx)("td",{className:e.props.canInspect?"script-turn-utterance-text inspectable":"script-turn-utterance-text",children:t})},a)}))]})})})}}]),a}(n.Component);var $e=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={hoveredTurn:{}},s}return Object(I.a)(a,[{key:"handleMouseOver",value:function(){var e;e=this.props.activeTurn,Boolean(e&&"object"===typeof e)&&!Object.keys(e).length&&this.setState({hoveredTurn:this.props.data})}},{key:"handleMouseOut",value:function(e){e.id!==this.props.activeTurn.id&&this.setState({hoveredTurn:{}})}},{key:"handleBarClick",value:function(e){this.props.handleBarClick(e)}},{key:"handleTextClick",value:function(e){this.props.handleTextClick(e)}},{key:"render",value:function(){var e=this.props.data,t="";switch(e.timestamp.length){case 0:break;case 1:t=e.timestamp[0];break;default:t="".concat(e.timestamp[0]," - ").concat(e.timestamp[e.timestamp.length-1])}var a=qe(e),n=a.teacherStyle,i=a.studentStyle,r=this.state.hoveredTurn.id===e.id||this.props.activeTurn.id===e.id;return Object(s.jsxs)("div",{className:"turn-taking-visualization-row",onMouseOver:this.handleMouseOver.bind(this,e),onMouseOut:this.handleMouseOut.bind(this,e),onClick:this.handleBarClick.bind(this,e),children:[Object(s.jsx)("div",{className:e.timestamp.length>1?"turn-taking-bar-timestamp-range":"turn-taking-bar-timestamp-time",children:t}),Object(s.jsxs)("div",{className:r?"turn-taking-bar active":"turn-taking-bar",children:[Object(s.jsx)("div",{className:"turn-taking-bar-teacher-outer",children:Object(s.jsx)("div",{className:"turn-taking-bar-teacher-inner",style:n})}),Object(s.jsx)("div",{className:"turn-taking-bar-student-outer",children:Object(s.jsx)("div",{className:"turn-taking-bar-student-inner",style:i})})]},e.id),r?Object(s.jsx)(Ze,{data:e,handleTextClick:this.handleTextClick.bind(this),canInspect:!0}):""]})}}]),a}(n.Component),et=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var n;Object(R.a)(this,a),(n=t.call(this,e)).toggleExpandedBars=function(e,t){this.setState({bars:e}),localStorage.setItem("bars",e)},n.barsStateIcon={expanded:Object(s.jsx)(te.a,{path:ae.b,className:"turn-taking-visualization-heading-icon",onClick:n.toggleExpandedBars.bind(Object(Ke.a)(n),"collapsed"),size:1}),collapsed:Object(s.jsx)(te.a,{path:ae.c,className:"turn-taking-visualization-heading-icon",onClick:n.toggleExpandedBars.bind(Object(Ke.a)(n),"expanded"),size:1})};var i=localStorage.getItem("bars")||"expanded";return n.state={bars:i,activeFilters:[],activeTurn:{}},n}return Object(I.a)(a,[{key:"handleFilterClick",value:function(e){var t=this.state.activeFilters;t.includes(e.value)?t=Pe(e.value,t):t.push(e.value),this.setState({activeFilters:t})}},{key:"handleBarClick",value:function(e){e.id===this.state.activeTurn.id&&(e={}),this.setState({activeTurn:e})}},{key:"handleTextClick",value:function(e){var t=this.props.location.pathname.slice(this.props.location.pathname.lastIndexOf("/")),a=this.props.location.pathname.replace(t,"/transcript#".concat(e));this.props.history.push(a)}},{key:"render",value:function(){var e=this;if(!this.props.datasets.activeParser)return null;var t=this.props.datasets.activeParser,a=t.parsedData({activeFilters:this.state.activeFilters})[this.state.bars]||[];return Object(s.jsxs)("div",{className:"turn-taking-visualization-container",children:[Object(s.jsxs)("div",{className:"turn-taking-legend-teacher",children:[Object(s.jsx)(ye,{labels:t.legendLabels({type:"Teacher"}),activeFilters:this.state.activeFilters,handleClick:this.handleFilterClick.bind(this)}),Object(s.jsx)(ye,{labels:t.legendLabels({type:"Technique"}),activeFilters:this.state.activeFilters,handleClick:this.handleFilterClick.bind(this)})]}),Object(s.jsxs)("div",{className:"turn-taking-visualization",children:[Object(s.jsxs)("div",{className:"turn-taking-visualization-headings",children:[Object(s.jsxs)("h2",{className:"turn-taking-visualization-heading",children:["Teacher Talk",this.barsStateIcon[this.state.bars]]}),Object(s.jsx)("h2",{className:"turn-taking-visualization-heading",children:"Student Talk"})]}),a.map((function(t,a){return Object(s.jsx)($e,{data:t,handleBarClick:e.handleBarClick.bind(e),handleTextClick:e.handleTextClick.bind(e),activeTurn:e.state.activeTurn},a)}))]}),Object(s.jsx)("div",{className:"turn-taking-legend-student",children:Object(s.jsx)(ye,{labels:t.legendLabels({type:"Student"}),activeFilters:this.state.activeFilters,handleClick:this.handleFilterClick.bind(this)})})]})}}]),a}(n.Component);var tt=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(et)),at=function(e){var t="/visualization";return e&&(t="/admin/user/".concat(e.userId,"/preview")),[{path:"".concat(t,"/dashboard"),component:function(e){return Object(s.jsx)(Ae,Object(b.a)({},e))},buttonValue:"dashboard",label:"Dashboard",icon:Object(s.jsx)(te.a,{path:ae.l,className:"button-selector-item-icon",size:1})},{path:"".concat(t,"/talk-ratio"),component:function(e){return Object(s.jsx)(He,Object(b.a)({},e))},buttonValue:"talk-ratio",label:"Talk Ratio",icon:Object(s.jsx)(te.a,{path:ae.e,className:"button-selector-item-icon",size:1.5})},{path:"".concat(t,"/turn-taking"),component:function(e){return Object(s.jsx)(tt,Object(b.a)({},e))},buttonValue:"turn-taking",label:"Turn Taking",icon:Object(s.jsx)(te.a,{path:ae.f,className:"button-selector-item-icon",size:1})},{path:"".concat(t,"/transcript"),component:function(e){return Object(s.jsx)(Ye,Object(b.a)({},e))},buttonValue:"transcript",label:"Transcript",icon:Object(s.jsx)(te.a,{path:ae.i,className:"button-selector-item-icon",size:1})}]},st=at().reduce((function(e,t){return e.push(t.path),e}),[]),nt={definitions:at,paths:st},it=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=e.location.pathname.slice(e.location.pathname.lastIndexOf("/")+1);return a!==e.buttonSelectorSelectedOption&&this.handleClick(a),!0}},{key:"handleClick",value:function(e){this.props.handleClick(e)}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"button-selector",children:[Object(s.jsx)("div",{className:"button-selector-options",children:nt.definitions(this.props.admin).map((function(t,a,n){return Object(s.jsxs)(H.b,{className:e.props.buttonSelectorSelectedOption===t.buttonValue?"button-selector-item active":"button-selector-item","data-attr-name":t.buttonValue,to:t.path,onClick:e.handleClick.bind(e,t.buttonValue),children:[t.icon,Object(s.jsx)("span",{className:"button-selector-item-text",children:t.label})]},a)}))}),this.props.admin?Object(s.jsx)("div",{className:"button-selector-admin-options",children:Object(s.jsxs)(H.b,{className:"button-selector-item active","data-attr-name":"admin-user",to:"/admin/user/".concat(this.props.admin.userId),children:[Object(s.jsx)(te.a,{path:ae.a,className:"button-selector-item-icon",size:1}),Object(s.jsx)("span",{className:"button-selector-item-text",children:"Back to User Page"})]})}):""]})}}]),a}(n.Component);var rt=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(it)),ct=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={isCollapsed:!1},s}return Object(I.a)(a,[{key:"toggleGroup",value:function(e){this.setState({isCollapsed:!e})}},{key:"render",value:function(){var e=this,t=this.state.isCollapsed,a="dashboard"===this.props.buttonSelectorSelectedOption?"".concat(this.props.match.url,"/talk-ratio"):"".concat(this.props.match.url,"/").concat(this.props.buttonSelectorSelectedOption);return Object(s.jsxs)("div",{className:"sidebar-group-container",children:[Object(s.jsxs)("div",{className:t?"sidebar-group-dropdown collapsed":"sidebar-group-dropdown expanded",onClick:this.toggleGroup.bind(this,this.state.isCollapsed),children:[Object(s.jsx)("span",{className:"sidebar-group-dropdown-text",children:this.props.label}),t?Object(s.jsx)(te.a,{path:ae.h,size:1}):Object(s.jsx)(te.a,{path:ae.g,size:1})]}),Object(s.jsx)("div",{className:"sidebar-group-data",children:(this.props.datasets.dataParsers||[]).map((function(t,n,i){var r=t.data,c=t.topic,o=Ie(t.date),l=t.period;return Object(s.jsx)(H.b,{to:a,exact:"true",children:Object(s.jsxs)("div",{className:e.props.datasets.activeDataRowIndex!==n||e.props.hideActive?"sidebar-data-row":"sidebar-data-row active",onClick:e.props.handleSidebarRowCourseClick.bind(e,n),children:[Object(s.jsx)("div",{className:"sidebar-data-row-title",children:c}),Object(s.jsxs)("div",{className:"sidebar-data-row-descriptor",children:[Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-label",children:"Date:"}),Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-value",children:o})]}),Object(s.jsxs)("div",{className:"sidebar-data-row-descriptor",children:[Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-label",children:l.length>1?"Periods:":"Period:"}),Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-value",children:l.join(", ")})]}),Object(s.jsxs)("div",{className:"sidebar-data-row-descriptor",children:[Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-label",children:"Duration:"}),Object(s.jsx)("span",{className:"sidebar-data-row-descriptor-value",children:L(r.duration)})]})]})},n)}))})]})}}]),a}(n.Component);var ot=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets}}),{})(ct)),lt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"transitionToDashboard",value:function(){this.props.history.push("/dashboard")}},{key:"render",value:function(){var e=this.props.location.pathname.includes("dashboard"),t=this.props,a=t.buttonSelectorSelectedOption,n=t.sidebarSelectedCourse;return Object(s.jsx)("div",{className:"sidebar",children:Object(s.jsx)(ot,{label:"Courses",hideActive:e,buttonSelectorSelectedOption:a,sidebarSelectedCourse:n,handleSidebarRowCourseClick:this.props.handleSidebarRowCourseClick.bind(this)})})}}]),a}(n.Component);var dt=Object($.f)(Object(o.b)((function(e){return{datasets:e.datasets,auth:e.auth}}),{showDataset:oe,listDatasets:le})(lt)),ut=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){var e=this.props,t=e.buttonSelectorSelectedOption,a=e.sidebarSelectedCourse,n=e.admin;return Object(s.jsxs)("div",{children:[Object(s.jsx)(rt,{admin:n,buttonSelectorSelectedOption:t,handleClick:this.props.handleButtonSelectorClick.bind(this)}),Object(s.jsx)(dt,{buttonSelectorSelectedOption:t,sidebarSelectedCourse:a,handleSidebarRowCourseClick:this.props.handleSidebarRowCourseClick.bind(this)})]})}}]),a}(n.Component),ht=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={sidebarSelectedCourse:localStorage.getItem("activeDataRowIndex"),buttonSelectorSelectedOption:localStorage.getItem("buttonSelectorSelectedOption"),areDatasetsLoaded:!1,admin:{userId:e.match.params.userId}},s}return Object(I.a)(a,[{key:"handleSidebarRowCourseClick",value:function(e){this.props.showDataset(e),localStorage.setItem("activeDataRowIndex",e),this.setState({sidebarSelectedCourse:e})}},{key:"handleButtonSelectorClick",value:function(e){localStorage.setItem("buttonSelectorSelectedOption",e),this.setState({buttonSelectorSelectedOption:e})}},{key:"dashboardRoutes",value:function(e){return nt.definitions(this.state.admin)}},{key:"componentDidMount",value:function(){var e=this;this.props.listDatasets(this.state.admin.userId).then((function(t){e.setState({areDatasetsLoaded:!0})}))}},{key:"render",value:function(){return Object(s.jsxs)("div",{children:[Object(s.jsx)(ut,{admin:this.state.admin,sidebarSelectedCourse:this.state.sidebarSelectedCourse,handleSidebarRowCourseClick:this.handleSidebarRowCourseClick.bind(this),buttonSelectorSelectedOption:this.state.buttonSelectorSelectedOption,handleButtonSelectorClick:this.handleButtonSelectorClick.bind(this),datasets:this.props.datasets}),Object(s.jsx)("div",{className:"dashboard-content",children:this.dashboardRoutes(this.state.admin).map((function(e,t){return Object(s.jsx)(fe,{exact:!0,path:e.path,component:e.component},t)}))})]})}}]),a}(n.Component);var pt=Object($.f)(Object(o.b)((function(e){return{admin:e.admin,auth:e.auth,datasets:e.datasets}}),{listDatasets:le,showDataset:oe})(ht)),bt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={sidebarSelectedCourse:localStorage.getItem("activeDataRowIndex"),buttonSelectorSelectedOption:localStorage.getItem("buttonSelectorSelectedOption"),areDatasetsLoaded:!1},s}return Object(I.a)(a,[{key:"handleSidebarRowCourseClick",value:function(e){this.props.showDataset(e),localStorage.setItem("activeDataRowIndex",e),this.setState({sidebarSelectedCourse:e})}},{key:"handleButtonSelectorClick",value:function(e){localStorage.setItem("buttonSelectorSelectedOption",e),this.setState({buttonSelectorSelectedOption:e})}},{key:"dashboardRoutes",value:function(e){return nt.definitions()}},{key:"componentDidMount",value:function(){var e=this;this.props.listDatasets(this.props.auth.user.id).then((function(t){e.setState({areDatasetsLoaded:!0})}))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return Object(s.jsxs)("div",{children:[Object(s.jsx)(ut,{sidebarSelectedCourse:this.state.sidebarSelectedCourse,handleSidebarRowCourseClick:this.handleSidebarRowCourseClick.bind(this),buttonSelectorSelectedOption:this.state.buttonSelectorSelectedOption,handleButtonSelectorClick:this.handleButtonSelectorClick.bind(this)}),Object(s.jsx)("div",{className:"dashboard-content",children:this.dashboardRoutes().map((function(e,t){return Object(s.jsx)(fe,{exact:!0,path:e.path,component:e.component},t)}))})]})}}]),a}(n.Component);var jt=Object($.f)(Object(o.b)((function(e){return{admin:e.admin,auth:e.auth,datasets:e.datasets}}),{listDatasets:le,showDataset:oe})(bt)),mt=[{label:"Teacher",value:50},{label:"Researcher",value:100}],vt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).onChange=function(e){s.setState({[e.target.id]:e.target.value})},s.state={isEditingUser:!1,errors:{},name:e.user.name,email:e.user.email,userType:e.user.userType},s}return Object(I.a)(a,[{key:"userTypeAsWords",value:function(e){return mt.filter((function(t){return t.value===e}))[0]&&mt.filter((function(t){return t.value===e}))[0].label}},{key:"toggleEditingUser",value:function(e){this.setState({isEditingUser:e||!1})}},{key:"deleteUser",value:function(e,t){this.props.deleteUser(e,t)}},{key:"editUser",value:function(e){var t={_id:e,name:this.state.name,email:this.state.email,userType:parseInt(this.state.userType,10)};this.props.editUser({user:t}),this.toggleEditingUser()}},{key:"render",value:function(){var e=this.props,t=e.isCurrentUser,a=e.isDeletingUser,n=e.user,i=this.state,r=i.name,c=i.email,o=i.userType,l=this.state,d=l.isEditingUser,u=l.errors;return d?Object(s.jsxs)("tr",{children:[Object(s.jsxs)("td",{children:[Object(s.jsx)("input",{onChange:this.onChange,value:r,error:u.name,id:"name",type:"text",className:pe()("",{invalid:u.name})}),Object(s.jsx)("span",{className:"input-field-error-text",children:u.name})]}),Object(s.jsxs)("td",{children:[Object(s.jsx)("input",{onChange:this.onChange,value:c,error:u.email,id:"email",type:"email",className:pe()("",{invalid:u.email})}),Object(s.jsx)("span",{className:"input-field-error-text",children:u.email})]}),Object(s.jsx)("td",{className:"text-center",children:Object(s.jsx)("select",{name:"userType",id:"userType",onChange:this.onChange,value:o,children:mt.map((function(e,t){return Object(s.jsx)("option",{name:e.value,id:e.value,value:e.value,children:e.label},t)}))})}),Object(s.jsxs)("td",{className:"admin-table-actions",children:[Object(s.jsx)("span",{className:"btn",onClick:this.toggleEditingUser.bind(this,null),children:"Cancel"}),Object(s.jsx)("span",{className:"btn",onClick:this.editUser.bind(this,n._id),children:"Save user"})]})]}):a?Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:r}),Object(s.jsx)("td",{children:c}),Object(s.jsx)("td",{className:"text-center",children:this.userTypeAsWords(o)}),Object(s.jsxs)("td",{className:"admin-table-actions-confirm",children:[Object(s.jsx)("span",{className:"admin-table-actions-confirm-text",children:"Are you sure?"}),Object(s.jsxs)("div",{className:"admin-table-actions-confirm-buttons",children:[Object(s.jsx)("span",{className:"btn",onClick:this.deleteUser.bind(this,n,!0),children:"Yes, delete"}),Object(s.jsx)("span",{className:"btn",onClick:this.deleteUser.bind(this,n,!1),children:"No, cancel"})]})]})]}):Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:n.name}),Object(s.jsx)("td",{children:n.email}),Object(s.jsx)("td",{className:"text-center",children:this.userTypeAsWords(n.userType)}),Object(s.jsxs)("td",{className:"admin-table-actions",children:[Object(s.jsx)(H.b,{to:{pathname:"/admin/user/".concat(n._id),state:{user:n}},children:Object(s.jsx)("span",{className:"btn",children:"View"})}),Object(s.jsx)("span",{className:"btn",onClick:this.toggleEditingUser.bind(this,n),children:"Edit"}),t?"":Object(s.jsx)("span",{className:"btn",onClick:this.deleteUser.bind(this,n,!1),children:"Delete"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object.keys(e.errors).length>0&&t.email!==e.user.email?{errors:e.errors,isEditingUser:!0}:null}}]),a}(n.Component),Ot=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{editUser:function(e){return function(t){q.a.post("/api/users/edit",e).then((function(a){console.log("Success. Edited user: ",e),t({type:y,payload:{userData:e}})})).catch((function(e){console.log("Error:",e),t({type:j,payload:e.response&&e.response.data})}))}}})(Object($.f)(vt)),ft=["Abundant","Accurate","Adorable","Adventurous","Alert","Aloof","Ambitious","Ancient","Animated","Awesome","Abandoned","Abashed","Abatable","Abbreviated","Abducting","Aberrant","Abeyant","Abiding","Bashful","Beautiful","Beneficial","Best","Big","Black","Blue","Boring","Brainy","Bright","Broad","Broken","Busy","Basal","Basaltic","Based","Baseless","Basic","Battleful","Battlemented","Batty","Batwing","Bias","Calm","Capable","Careful","Caring","Cautious","Charming","Cheap","Cheerful","Clean","Clever","Cold","Colorful","Comfortable","Concerned","Confused","Crowded","Curious","Curly","Dangerous","Dark","Delighted","Deep","Delicate","Delicious","Determined","Different","Dry","Dusty","Daily","Dainty","Damp","Dampish","Darkling","Darned","Dauntless","Daylong","Early","Educated","Efficient","Elegant","Empty","Encouraging","Enthusiastic","Excellent","Exciting","Expensive","Fabulous","Fair","Faithful","Famous","Fancy","Fantastic","Fast","Fearless","Friendly","Funny","Gentle","Glamorous","Glorious","Gorgeous","Graceful","Grateful","Great","Green","Handsome","Happy","Healthy","Heavy","Helpful","Hilarious","Historical","Humorous","Hungry","Imaginary","Important","Impossible","Interesting","Jazzed","Jealous","Jolly","Kind","Large","Legal","Light","Literate","Little","Lively","Loud","Lovely","Lucky","Magical","Massive","Messy","Modern","Narrow","Nervous","New","Peaceful","Pink","Polite","Powerful","Precious","Proud","Quick","Quiet","Rapid","Rare","Red","Remarkable","Responsible","Rich","Royal","Secretive","Serious","Sharp","Shiny","Shocking","Short","Shy","Silly","Sincere","Splendid","Strong","Successful","Sweet","Talented","Tall","Terrific","Tactful","Talented","Tangible","Tasteful","Tasty","Teachable","Teeming","Temperate","Tenable","Tenacious","Tender","Terrific","Testimonial","Thankful","Thankworthy","Therapeutic","Thoughtful","Unique","Victorious","Warm","Wide","Wise","Witty","Wonderful","Zealous"],gt=["Actor","Gold","Painting","Advertisement","Grass","Parrot","Afternoon","Greece","Pencil","Airport","Guitar","Piano","Ambulance","Hair","Pillow","Animal","Hamburger","Pizza","Answer","Helicopter","Planet","Apple","Helmet","Plastic","Army","Holiday","Portugal","Australia","Honey","Potato","Balloon","Horse","Queen","Banana","Hospital","Quill","Battery","House","Rain","Beach","Hydrogen","Rainbow","Beard","Ice","Raincoat","Bed","Insect","Refrigerator","Belgium","Insurance","Restaurant","Boy","Iron","River","Branch","Island","Rocket","Breakfast","Jackal","Room","Jelly","Rose","Camera","Candle","Jordan","Sandwich","Car","Juice","School","Caravan","Kangaroo","Scooter","Carpet","King","Shampoo","Cartoon","Kitchen","Shoe","China","Kite","Soccer","Church","Knife","Spoon","Crayon","Lamp","Stone","Crowd","Lawyer","Sugar","Leather","Sweden","Death","Library","Teacher","Denmark","Lighter","Telephone","Diamond","Lion","Television","Dinner","Lizard","Tent","Disease","Lock","Thailand","Doctor","London","Tomato","Dog","Lunch","Toothbrush","Dream","Machine","Traffic","Dress","Magazine","Train","Truck","Egg","Market","Umbrella","Egypt","Match","Van","Elephant","Microphone","Vase","Energy","Vegetable","Engine","Morning","England","Motorcycle","Wall","Evening","Nail","Whale","Eye","Napkin","Window","Needle","Wire","Nest","Xylophone","Fish","Yacht","Flag","Night","Yak","Flower","Notebook","Zebra","Football","Ocean","Zoo","Forest","Oil","Garden","Fountain","Orange","Gas","France","Oxygen","Furniture","Oyster","Glass","Garage"];var xt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).onChange=function(e){s.setState({[e.target.id]:e.target.value})},s.onSubmit=function(e){e.preventDefault();var t={name:s.state.name,email:s.state.email,userType:s.state.userType,password:s.state.password,password2:s.state.password2};s.props.createUser(t)},s.state={name:"",email:"",userType:50,password:"",password2:"",errors:{},emailCopied:!1},s}return Object(I.a)(a,[{key:"generateGmailUsername",value:function(){var e,t,a=ft[Math.floor(Math.random()*ft.length)],s=gt[Math.floor(Math.random()*gt.length)],n=(e=100,t=999,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),i="".concat(a).concat(s).concat(n);navigator.clipboard.writeText(i),this.setState({name:i,email:"".concat(i,"@gmail.com"),emailCopied:!0})}},{key:"render",value:function(){var e=this.state.errors;return Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsxs)("div",{className:"form-header",children:[Object(s.jsx)("h2",{children:"Create new user"}),Object(s.jsx)(te.a,{className:"icon",path:ae.j,title:"Create Gmail account",size:1.5,color:"#0363f3",onClick:this.generateGmailUsername.bind(this)})]}),this.state.emailCopied?Object(s.jsx)("span",{className:"form-confirmation",children:Object(s.jsx)("a",{href:"https://accounts.google.com/signup/v2/webcreateaccount?continue=https%3A%2F%2Faccounts.google.com%2FManageAccount%3Fnc%3D1&dsh=S2114698834%3A1605300939529596&gmb=exp&biz=false&flowName=GlifWebSignIn&flowEntry=SignUp&nogm=true",target:"_blank",rel:"noopener noreferrer",children:"Username copied to clipboard. Click here to create a Google account."})}):"",Object(s.jsxs)("form",{noValidate:!0,children:[Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"name",children:"Name"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.name,error:e.name,id:"name",type:"text",className:pe()("",{invalid:e.name})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.name})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"email",children:"Email"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.email,error:e.email,id:"email",type:"email",autoComplete:"username",className:pe()("",{invalid:e.email})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.email})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"userType",children:"User Type"}),Object(s.jsx)("select",{name:"userType",id:"userType",onChange:this.onChange,value:this.state.userType,children:mt.map((function(e,t){return Object(s.jsx)("option",{name:e.value,id:e.value,value:e.value,children:e.label},t)}))})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password,error:e.password,id:"password",type:"password",autoComplete:"new-password",className:pe()("",{invalid:e.password})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password2,error:e.password2,id:"password2",type:"password",autoComplete:"new-password",className:pe()("",{invalid:e.password2})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password2})]}),Object(s.jsx)("button",{type:"submit",className:"btn btn-submit",onClick:this.onSubmit.bind(this),children:"Create user"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.errors?{errors:e.errors}:null}}]),a}(n.Component),yt=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{createUser:function(e){return function(t){q.a.post("/api/users/register",e).then((function(e){console.log("Success. Added user: ",e),t({type:f,payload:{user:e.data}})})).catch((function(e){console.log("Error:",e,e.response&&e.response.data),t({type:j,payload:e.response&&e.response.data})}))}}})(Object($.f)(xt)),kt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={isCreatingUser:!1,isDeletingUser:!1,userToDelete:{}},s}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchUsers()}},{key:"shouldComponentUpdate",value:function(e,t){return e.admin.isValidUser&&this.state.isCreatingUser&&this.toggleCreateUser(),!0}},{key:"toggleCreateUser",value:function(){this.state.isCreatingUser&&this.props.clearIsValidUser(),this.setState({isCreatingUser:!this.state.isCreatingUser})}},{key:"deleteUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&(this.props.deleteUserById(e),this.setState({userToDelete:{}})),e._id!==this.state.userToDelete._id||t?0===Object.entries(this.state.userToDelete).length&&this.setState({userToDelete:e}):this.setState({userToDelete:{}})}},{key:"render",value:function(){var e=this,t=this.state.users;return Object(s.jsxs)("div",{className:"admin",children:[Object(s.jsxs)("div",{className:"admin-header",children:[Object(s.jsx)("span",{className:"btn",onClick:this.toggleCreateUser.bind(this),children:this.state.isCreatingUser?"Cancel":"Create new user"}),this.state.isCreatingUser?Object(s.jsx)(yt,{}):""]}),Object(s.jsxs)("table",{className:"admin-table",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"Email"}),Object(s.jsx)("th",{children:"User Type"}),Object(s.jsx)("th",{children:"Actions"})]})}),Object(s.jsx)("tbody",{children:(t||[]).map((function(t,a){if(!t)return null;var n=e.props.auth.user.id===t._id,i=t._id&&e.state.userToDelete._id===t._id;return Object(s.jsx)(Ot,{user:t,isCurrentUser:n,isDeletingUser:i,deleteUser:e.deleteUser.bind(e)},a)}))})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.admin.users?{users:e.admin.users,isDeletingUser:!1}:null}}]),a}(n.Component);var Ct=Object(o.b)((function(e){return{auth:e.auth,admin:e.admin,datasets:e.datasets}}),{fetchUsers:function(){return function(e){return q.a.get("/api/users/list").then((function(e){return e})).then((function(t){e({type:O,payload:t})})).catch((function(e){throw e}))}},deleteUserById:function(e){return function(t){q.a.post("/api/users/delete",{user:e}).then((function(e){t({type:x,payload:e})})).catch((function(e){console.log("Error deleting user:",e)}))}},clearIsValidUser:function(){return function(e){e({type:g,payload:null}),e({type:j,payload:{}})}}})(kt),Tt=a(19),St=a.n(Tt),wt=a(53),Nt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).onChange=function(e){s.setState({fileData:Object(b.a)(Object(b.a)({},s.state.fileData),{},{[e.target.id]:e.target.value})})},s.parseFile=function(){var e=Object(wt.a)(St.a.mark((function e(t){var a,n;return St.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=s.state.userId,t.preventDefault(),n=new FileReader;try{n.readAsText(t.target.files[0])}catch(i){console.error(i),s.setState({isUploaded:!1,fileData:{}})}n.onload=function(){var e=Object(wt.a)(St.a.mark((function e(t){var n,i,r,c,o,l,d;return St.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.result,i=JSON.parse(n),r=document.getElementById("data-upload-input"),c=r.value.split("\\")[2],o=c.split("_"),l=(l=o[1]).replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),d=o[2].replace("Per","").replace(".json","").replace("_",", "),s.setState({isUploaded:!0,fileData:{userId:a,filename:c,classTopic:"",classDate:l,classPeriod:d,jsonData:i}});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onSubmit=function(e){e.preventDefault();var t=s.state.fileData;s.props.uploadDataset(t)},s.state={errors:{},userId:e.userId,classTopic:"",isUploaded:!1,isValid:!1},s}return Object(I.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.datasets.isValid&&this.dismountForm(),!0}},{key:"dismountForm",value:function(){this.props.dismountForm()}},{key:"render",value:function(){var e=this,t=this.state.errors;return Object(s.jsxs)("div",{className:"form-container wide",children:[Object(s.jsx)("div",{children:Object(s.jsx)("h2",{className:"text-center",children:"Upload data"})}),Object(s.jsxs)("form",{noValidate:!0,onSubmit:this.onSubmit,children:[Object(s.jsx)("input",{id:"data-upload-input",type:"file",accept:"application/JSON",onChange:function(t){return e.parseFile(t)}}),this.state.isUploaded?Object(s.jsxs)("div",{className:"even-columns-2",children:[Object(s.jsxs)("div",{className:"even-column",children:[Object(s.jsx)("span",{className:"data-upload-label",children:"Preview"}),Object(s.jsx)("pre",{className:"data-upload-json",children:JSON.stringify(this.state.fileData.jsonData,null,2)})]}),Object(s.jsxs)("div",{className:"even-column data-upload-metadata",children:[Object(s.jsxs)("div",{className:"data-upload-metadata-fields",children:[Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"topic",children:"Class Topic"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.fileData.classTopic,id:"classTopic",type:"text",error:t.classTopic,className:pe()("",{invalid:t.classTopic})}),Object(s.jsx)("span",{className:"input-field-error-text",children:t.classTopic})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"date",children:"Date"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.fileData.classDate,id:"classDate",type:"date"})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"period",children:"Period(s), comma-separated"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.fileData.classPeriod,id:"classPeriod",type:"text",error:t.classPeriod,className:pe()("",{invalid:t.classPeriod})}),Object(s.jsx)("span",{className:"input-field-error-text",children:t.classPeriod})]})]}),Object(s.jsx)("button",{type:"submit",className:"btn btn-submit",children:"Upload"})]})]}):""]})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object.keys(e.errors).length>0?{errors:e.errors}:null}}]),a}(n.Component);var Dt=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors,datasets:e.datasets,admin:e.admin}}),{uploadDataset:function(e){return function(t){q.a.post("/api/datasets/upload",e).then((function(e){console.log("Success. Added dataset:",e),t({type:S,payload:{dataset:e.data}})})).catch((function(e){console.error(e),console.error(e.response&&e.response.data),t({type:j,payload:e.response&&e.response.data})}))}}})(Object($.f)(Nt)),Et=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this,e)).state={isJsonDataExpanded:!1},s}return Object(I.a)(a,[{key:"deleteDataset",value:function(e,t){this.props.deleteDataset(e,t)}},{key:"expandJsonData",value:function(){this.setState({isJsonDataExpanded:!this.state.isJsonDataExpanded})}},{key:"toggleActive",value:function(e){var t=Object(b.a)(Object(b.a)({},e),{},{isActive:!e.isActive});this.props.editDataset({dataset:t}),this.setState({dataset:t})}},{key:"render",value:function(){var e=this.props,t=e.isDeletingDataset,a=e.dataset,n=JSON.stringify(JSON.parse(a.jsonData),null,2);return t?Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:a.classTopic}),Object(s.jsx)("td",{className:"text-center",children:Ie(a.classDate)}),Object(s.jsx)("td",{className:"text-center",children:a.classPeriod}),Object(s.jsxs)("td",{className:"admin-table-actions-confirm",children:[Object(s.jsx)("span",{className:"admin-table-actions-confirm-text",children:"Are you sure?"}),Object(s.jsxs)("div",{className:"admin-table-actions-confirm-buttons",children:[Object(s.jsx)("span",{className:"btn",onClick:this.deleteDataset.bind(this,a,!0),children:"Yes, delete"}),Object(s.jsx)("span",{className:"btn",onClick:this.deleteDataset.bind(this,a,!1),children:"No, cancel"})]})]})]}):[Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:a.classTopic}),Object(s.jsx)("td",{className:"text-center",children:Ie(a.classDate)}),Object(s.jsx)("td",{className:"text-center",children:a.classPeriod.join(", ")}),Object(s.jsxs)("td",{className:"admin-table-dataset-actions",children:[Object(s.jsx)("span",{className:"btn",onClick:this.expandJsonData.bind(this),children:this.state.isJsonDataExpanded?"Hide Raw JSON":"View Raw JSON"}),Object(s.jsx)("span",{className:"btn",onClick:this.toggleActive.bind(this,a),children:a.isActive?"Mark inactive":"Mark active"}),Object(s.jsx)("span",{className:"btn",onClick:this.deleteDataset.bind(this,a,!1),children:"Delete"})]})]},a._id),this.state.isJsonDataExpanded&&Object(s.jsx)("tr",{children:Object(s.jsx)("td",{colSpan:"4",children:Object(s.jsx)("pre",{className:"admin-table-json",children:n})})},"".concat(a._id,"-data"))]}}]),a}(n.Component),Rt=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{editDataset:function(e){return function(t){q.a.post("/api/datasets/edit",e).then((function(a){console.log("Success. Edited dataset:",e.dataset),t({type:N,payload:e})})).catch((function(e){console.error(e)}))}}})(Object($.f)(Et)),Ft=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;return Object(R.a)(this,a),(s=t.call(this)).onChange=function(e){s.setState({[e.target.id]:e.target.value})},s.onSubmit=function(e){e.preventDefault();var t={userId:s.state.userId,password:s.state.password,password2:s.state.password2};s.props.resetUserPassword(t)},s.state={userId:e.userId,password:"",password2:"",errors:{}},s}return Object(I.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.admin.passwordResetSuccessful&&this.dismountForm({message:"Password reset successfully: ".concat(this.state.password)}),!0}},{key:"dismountForm",value:function(e){this.props.dismountForm(e)}},{key:"render",value:function(){var e=this.state.errors;return Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsx)("h2",{className:"text-center",children:"Reset Password"}),Object(s.jsxs)("form",{noValidate:!0,onSubmit:this.onSubmit,children:[Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password,error:e.password,id:"password",type:"password",autoComplete:"new-password",className:pe()("",{invalid:e.password})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password})]}),Object(s.jsxs)("div",{className:"input-field",children:[Object(s.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(s.jsx)("input",{onChange:this.onChange,value:this.state.password2,error:e.password2,id:"password2",type:"password",autoComplete:"new-password",className:pe()("",{invalid:e.password2})}),Object(s.jsx)("span",{className:"input-field-error-text",children:e.password2})]}),Object(s.jsx)("button",{type:"submit",className:"btn btn-submit",children:"Submit"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.errors?{errors:e.errors}:null}}]),a}(n.Component),Ut=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors,admin:e.admin,datasets:e.datasets}}),{resetUserPassword:function(e){return function(t){q.a.post("/api/users/reset-password",e).then((function(e){t({type:C,payload:{passwordResetSuccessful:!0}})})).catch((function(e){return t({type:j,payload:e.response.data})}))}}})(Object($.f)(Ft)),It=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(e){var s;Object(R.a)(this,a),s=t.call(this,e);var n=e.match.params.userId;return s.state={isUploadingData:!1,isResettingPassword:!1,userId:n,datasets:[],datasetToDelete:{},isLoaded:!1,showMessage:!1,message:"",areDatasetsLoaded:!1},s}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.showUserDetails(this.state.userId),this.state.areDatasetsLoaded||this.props.listDatasets(this.state.userId).then((function(t){e.setState({areDatasetsLoaded:!0})}))}},{key:"userTypeAsWords",value:function(e){return mt.filter((function(t){return t.value===e}))[0]&&mt.filter((function(t){return t.value===e}))[0].label}},{key:"toggleUploadData",value:function(){this.setState((function(e){return{isUploadingData:!e.isUploadingData}}))}},{key:"toggleResetPassword",value:function(){this.setState((function(e){return{isResettingPassword:!e.isResettingPassword}}))}},{key:"deleteDataset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&(this.props.deleteDatasetById(e),this.setState({datasetToDelete:{}})),e._id!==this.state.datasetToDelete._id||t?0===Object.entries(this.state.datasetToDelete).length&&this.setState({datasetToDelete:e}):this.setState({datasetToDelete:{}})}},{key:"dismountForm",value:function(e){var t=this;e&&e.message?(this.setState({showMessage:!0,message:e.message}),setTimeout((function(){t.setState({showMessage:!1,message:""})}),3e3)):this.props.clearValidState(),this.setState({isUploadingData:!1,isResettingPassword:!1})}},{key:"render",value:function(){var e=this,t=this.state.user||{},a=this.props.datasets.datasets||[];return Object(s.jsxs)("div",{className:"admin-user",children:[Object(s.jsxs)("div",{className:"admin-header",children:[Object(s.jsx)(H.b,{to:{pathname:"/admin/user/".concat(this.state.userId,"/preview/dashboard")},children:Object(s.jsx)("span",{className:"btn",children:"Preview Teacher View"})}),Object(s.jsx)("span",{className:this.state.isResettingPassword?"hidden":"btn",onClick:this.toggleUploadData.bind(this),children:this.state.isUploadingData?"Cancel":"Upload data"}),Object(s.jsx)("span",{className:this.state.isUploadingData?"hidden":"btn",onClick:this.toggleResetPassword.bind(this),children:this.state.isResettingPassword?"Cancel":"Reset password"})]}),this.state.isUploadingData?Object(s.jsx)(Dt,{userId:t._id,dismountForm:this.dismountForm.bind(this)}):"",this.state.isResettingPassword?Object(s.jsx)(Ut,{userId:t._id,dismountForm:this.dismountForm.bind(this)}):"",this.state.showMessage?Object(s.jsx)("div",{className:"admin-confirmation-message",children:Object(s.jsx)("span",{className:"admin-confirmation-message-text",children:this.state.message})}):"",Object(s.jsxs)("div",{className:"admin-user-info",children:[Object(s.jsx)("span",{className:"admin-user-info-name",children:t.name}),Object(s.jsx)("span",{className:"admin-user-info-email",children:t.email}),Object(s.jsx)("span",{className:"admin-user-info-type",children:this.userTypeAsWords(t.userType)})]}),Object(s.jsxs)("table",{className:"admin-table",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Class Topic"}),Object(s.jsx)("th",{children:"Date"}),Object(s.jsx)("th",{children:"Period(s)"}),Object(s.jsx)("th",{children:"Actions"})]})}),Object(s.jsx)("tbody",{children:0===a.length?Object(s.jsx)("tr",{children:Object(s.jsx)("td",{colSpan:"4",className:"text-center",children:"This user doesn't have any datasets."})}):a.map((function(t,a,n){var i=t._id&&e.state.datasetToDelete._id===t._id;return Object(s.jsx)(Rt,{dataset:t,isDeletingDataset:i,deleteDataset:e.deleteDataset.bind(e)},a)}))})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e){return e.admin.user?{user:e.admin.user}:null}}]),a}(n.Component);var Pt=Object($.f)(Object(o.b)((function(e){return{auth:e.auth,datasets:e.datasets,admin:e.admin}}),{showUserDetails:function(e){return function(t){return q.a.get("/api/users/show",{params:{userId:e}}).then((function(e){t({type:k,payload:e&&e.data.user})})).catch((function(e){return console.error(e),e}))}},listDatasets:le,deleteDatasetById:function(e){return function(t){q.a.post("/api/datasets/edit",{dataset:Object(b.a)(Object(b.a)({},e),{},{isDeleted:!0})}).then((function(e){t({type:w,payload:e&&e.data})})).catch((function(e){console.log("Error deleting dataset:",e)}))}},clearValidState:function(){return function(e){e({type:E,payload:!1}),e({type:j,payload:{}})}}})(It)),Lt=function(e){Object(K.a)(a,e);var t=Object(Z.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{children:[Object(s.jsx)(ce,{datasets:this.props.datasets}),Object(s.jsx)($.b,{exact:!0,path:"/",component:ue}),Object(s.jsx)($.b,{exact:!0,path:"/register",component:je}),Object(s.jsx)($.b,{exact:!0,path:"/login",component:ve}),Object(s.jsx)(fe,{exact:!0,path:"/admin",component:function(e){return Object(s.jsx)(Ct,Object(b.a)({},e))}}),Object(s.jsx)(fe,{exact:!0,path:"/admin/user/:userId",component:function(e){return Object(s.jsx)(Pt,Object(b.a)({},e))}}),Object(s.jsx)(fe,{path:"/admin/user/:userId/preview",component:function(e){return Object(s.jsx)(pt,Object(b.a)({},e))}}),Object(s.jsx)(fe,{path:"/visualization",component:function(e){return Object(s.jsx)(jt,Object(b.a)({},e))}})]})}}]),a}(n.Component);var At=Object($.f)(Object(o.b)((function(e){return{auth:e.auth}}),{})(Lt));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));if(localStorage.jwtToken){var _t=localStorage.jwtToken;Q(_t);var Bt=Object(W.a)(_t);G.dispatch(X(Bt));var Mt=Date.now()/1e3;Bt.exp<Mt&&(G.dispatch(Y()),window.location.href="./login")}c.a.render(Object(s.jsx)(o.a,{store:G,children:Object(s.jsx)(H.a,{children:Object(s.jsx)(At,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[221,1,2]]]);
//# sourceMappingURL=main.187f05e0.chunk.js.map